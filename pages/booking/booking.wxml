<!-- pages/booking/booking.wxml -->
<view class="container" wx:if="{{product}}">
  <!-- 产品信息摘要 -->
  <view class="product-summary">
    <view class="summary-title">{{product.title}}</view>
    <view class="summary-meta">
      <text>📍 {{product.location}}</text>
      <text>⏱️ {{product.duration}}</text>
      <text class="summary-price">¥{{product.price}}/人</text>
    </view>
  </view>

  <!-- 出行日期 -->
  <view class="form-section">
    <view class="section-title">📅 选择出行日期</view>
    <picker mode="date" value="{{travelDate}}" start="{{today}}" bindchange="onDateChange">
      <view class="picker">
        {{travelDate || '请选择日期'}}
      </view>
    </picker>
  </view>

  <!-- 出行人信息 -->
  <view class="form-section">
    <view class="section-title">👥 出行人信息</view>
    <view class="section-subtitle">
      💡 支持子女代为预订，请填写实际出行人（父母）信息
    </view>
    
    <view wx:for="{{travelers}}" wx:key="index" class="traveler-card">
      <view class="traveler-header">
        <text class="traveler-number">出行人 {{index + 1}}</text>
        <button wx:if="{{travelers.length > 1}}" class="remove-btn" bind:tap="removeTraveler" data-index="{{index}}">
          删除
        </button>
      </view>
      
      <view class="form-field">
        <view class="field-label">姓名 *</view>
        <input class="field-input" placeholder="请输入姓名" value="{{item.name}}" 
               bindinput="onTravelerChange" data-field="name" data-index="{{index}}" />
      </view>

      <view class="form-field">
        <view class="field-label">身份证号 *</view>
        <input class="field-input" placeholder="用于验证年龄和购买保险" value="{{item.idCard}}" 
               bindinput="onTravelerChange" data-field="idCard" data-index="{{index}}" />
      </view>

      <view class="form-field">
        <view class="field-label">手机号 *</view>
        <input class="field-input" type="number" placeholder="用于接收出行通知" value="{{item.phone}}" 
               bindinput="onTravelerChange" data-field="phone" data-index="{{index}}" />
      </view>

      <view class="form-field">
        <view class="field-label">与您的关系</view>
        <input class="field-input" placeholder="如：父亲、母亲、本人等" value="{{item.relation}}" 
               bindinput="onTravelerChange" data-field="relation" data-index="{{index}}" />
      </view>
    </view>

    <button class="add-traveler-btn" bind:tap="addTraveler">
      + 添加出行人
    </button>
  </view>

  <!-- 联系人信息 -->
  <view class="form-section">
    <view class="section-title">📞 联系人信息</view>
    <view class="section-subtitle">
      💡 用于接收订单确认和行程通知
    </view>

    <view class="form-field">
      <view class="field-label">联系人姓名 *</view>
      <input class="field-input" placeholder="请输入联系人姓名" value="{{contactName}}" 
             bindinput="onContactNameInput" />
    </view>

    <view class="form-field">
      <view class="field-label">联系电话 *</view>
      <input class="field-input" type="number" placeholder="请输入联系电话" value="{{contactPhone}}" 
             bindinput="onContactPhoneInput" />
    </view>
  </view>

  <!-- 订单金额 -->
  <view class="form-section price-section">
    <view class="price-item">
      <text class="price-label">产品单价</text>
      <text class="price-value">¥{{product.price}}</text>
    </view>
    <view class="price-item">
      <text class="price-label">出行人数</text>
      <text class="price-value">{{travelers.length}} 人</text>
    </view>
    <view class="price-item total">
      <text class="price-label">总计</text>
      <text class="price-value total-price">
        ¥{{product.price * travelers.length}}
      </text>
    </view>
  </view>

  <!-- 提交按钮 -->
  <view class="submit-section">
    <button class="submit-btn" bind:tap="submitOrder">
      提交订单
    </button>
  </view>

  <!-- 客服组件 -->
  <customer-service />
</view>
