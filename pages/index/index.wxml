<!-- pages/index/index.wxml -->
<view class="container">
  <!-- æœç´¢æ  -->
  <view class="search-header">
    <view class="header-top">
      <view class="page-title">è€å‹è¡Œ</view>
      <view class="user-info" bind:tap="showUserMenu">
        <text class="user-icon">ğŸ‘¤</text>
      </view>
    </view>
    <view class="search-box">
      <input class="search-input" placeholder="æœç´¢ç›®çš„åœ°æˆ–äº§å“åç§°" value="{{searchText}}" bindinput="onSearchInput" />
    </view>
  </view>

  <!-- ç­›é€‰åŒºåŸŸ -->
  <view class="filter-section">
    <view class="filter-group">
      <view class="filter-label">ç›®çš„åœ°ï¼š</view>
      <view class="filter-tags">
        <view wx:for="{{locations}}" wx:key="*this" 
              class="tag {{selectedLocation === item ? 'tag-active' : ''}}"
              bind:tap="selectLocation" data-location="{{item}}">
          {{item}}
        </view>
      </view>
    </view>

    <view class="filter-group">
      <view class="filter-label">ä½“åŠ›å¼ºåº¦ï¼š</view>
      <view class="filter-tags">
        <view wx:for="{{intensityLevels}}" wx:key="*this"
              class="tag {{selectedIntensity === item ? 'tag-active' : ''}}"
              bind:tap="selectIntensity" data-intensity="{{item}}">
          {{item}}
        </view>
      </view>
    </view>
  </view>

  <!-- äº§å“åˆ—è¡¨ -->
  <view class="products-container">
    <view wx:if="{{filteredProducts.length === 0}}" class="empty-state">
      <text class="empty-icon">ğŸ”</text>
      <text class="empty-text">æš‚æ— ç¬¦åˆæ¡ä»¶çš„äº§å“</text>
    </view>

    <view wx:for="{{filteredProducts}}" wx:key="id" class="product-card" bind:tap="goToDetail" data-id="{{item.id}}">
      <view class="product-image-container">
        <image class="product-image" src="{{item.imageUrl}}" mode="aspectFill" />
        <view class="product-tags-overlay">
          <view wx:for="{{item.tags}}" wx:for-item="tag" wx:key="*this" wx:if="{{index < 2}}" class="tag-overlay">
            {{tag}}
          </view>
        </view>
      </view>

      <view class="product-info">
        <view class="product-title">{{item.title}}</view>
        <view class="product-desc">{{item.description}}</view>

        <view class="product-meta">
          <view class="meta-item">
            <text class="meta-icon">ğŸ“</text>
            <text class="meta-text">{{item.location}}</text>
          </view>
          <view class="meta-item">
            <text class="meta-icon">â±ï¸</text>
            <text class="meta-text">{{item.duration}}</text>
          </view>
          <view class="meta-item">
            <text class="meta-icon">ğŸ‘¥</text>
            <text class="meta-text">{{item.groupSize}}</text>
          </view>
        </view>

        <view class="product-features">
          <view class="intensity-badge" style="background-color: {{item.intensityColor}};">
            {{item.intensity}}
          </view>
          <view class="age-badge">
            é€‚åˆ {{item.ageRange}}
          </view>
          <view wx:if="{{item.medicalSupport.hasDoctor}}" class="medical-badge">
            âš•ï¸ åŒ»æŠ¤éšè¡Œ
          </view>
        </view>

        <view class="product-footer">
          <view class="price-section">
            <text class="price-label">èµ·</text>
            <text class="price">Â¥{{item.price}}</text>
            <text class="price-unit">/äºº</text>
          </view>
          <view class="view-btn">æŸ¥çœ‹è¯¦æƒ…</view>
        </view>
      </view>
    </view>
  </view>

  <!-- å®¢æœç»„ä»¶ -->
  <customer-service />
</view>
